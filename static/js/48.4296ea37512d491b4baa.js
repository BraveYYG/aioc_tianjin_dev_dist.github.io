webpackJsonp([48],{"ELa/":function(e,t,a){(e.exports=a("FZ+f")(!0)).push([e.i,"\n.btns_box[data-v-44e5ece3] {\r\n  display: table;\n}\n.data_total[data-v-44e5ece3] {\r\n  display: table-cell;\r\n  text-align: left;\r\n  font-size: 0.16rem;\r\n  color: #a5dcff;\n}\n.data_total span[data-v-44e5ece3] {\r\n  font-weight: bolder;\r\n  color: #05e6ff;\r\n  margin-left: 30px;\n}\n.el-date-editor.el-input[data-v-44e5ece3],\r\n.el-date-editor.el-input__inner[data-v-44e5ece3] {\r\n  width: 1.6rem;\r\n  margin-right: 0.2rem;\n}\r\n","",{version:3,sources:["F:/web01/aioc-tianjin-dev/src/views/ServiceConsumption/index.vue"],names:[],mappings:";AACA;EACE,eAAe;CAChB;AACD;EACE,oBAAoB;EACpB,iBAAiB;EACjB,mBAAmB;EACnB,eAAe;CAChB;AACD;EACE,oBAAoB;EACpB,eAAe;EACf,kBAAkB;CACnB;AACD;;EAEE,cAAc;EACd,qBAAqB;CACtB",file:"index.vue",sourcesContent:["\n.btns_box[data-v-44e5ece3] {\r\n  display: table;\n}\n.data_total[data-v-44e5ece3] {\r\n  display: table-cell;\r\n  text-align: left;\r\n  font-size: 0.16rem;\r\n  color: #a5dcff;\n}\n.data_total span[data-v-44e5ece3] {\r\n  font-weight: bolder;\r\n  color: #05e6ff;\r\n  margin-left: 30px;\n}\n.el-date-editor.el-input[data-v-44e5ece3],\r\n.el-date-editor.el-input__inner[data-v-44e5ece3] {\r\n  width: 1.6rem;\r\n  margin-right: 0.2rem;\n}\r\n"],sourceRoot:""}])},H8II:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Gu7T"),r=a.n(n),i=a("woOf"),s=a.n(i),o=a("Dd8w"),c=a.n(o),l=a("bOdI"),u=a.n(l),d=a("P9l9"),h=a("NYxO"),f=a("sxQs"),m=a("hmat"),p=a("oAV5"),v=a("oqQY"),D=a.n(v),b={data:function(){return{pageSize:10,currentPage:1,isSearchLoading:!1,columns:[{label:"序号 ",prop:"key",width:100},{label:"载体名称",prop:"merchantName",width:400},{label:"载体级别",prop:"canteenLevel",width:150},{label:"服务商",prop:"companyName"},{label:"服务老年人数（人）",prop:"peopleTotal",width:200},{label:"服务量（客次）",prop:"serviceTotal",width:120},{label:"老年人消费频率人数（人）",value:"peoTotal",width:220}],streetData:[],attendanceRate:"10",formData:u()({beginDay:D()(new Date(new Date-24192e5)).format("YYYY-MM-DD"),endDay:D()(new Date).format("YYYY-MM-DD"),companyName:"",streetCode:"",attendanceSign:"",canteenLevel:""},"attendanceSign","1"),attendNumber:1,serviceLevel:"",serviceDate:{},companyList:[],tableData:[],totalData:{},streetCode:"",disabled:!1}},computed:c()({},Object(h.b)(["useName","type","code","typeNew","codeNew"]),{paramss:function(){var e={};return e[["code","zoneCode","streetCode","communityCode"][this.typeNew-1]]=this.codeNew[0],e}}),watch:{useName:function(e){this.getOtherPageList(this.useName,this.roleid)}},created:function(){var e=this;this.roleid=window.localStorage.getItem("roleid"),this.$store.dispatch("getUserAuthInfo").then(function(){e.streetCode=e.code[1],e.getServiceConditionInfo()}).catch(function(e){console.log("获取用户权限失败",e)}),this.getServiceConditionInfo(),d.a.getStreetInfo().then(function(t){t&&(e.streetData=t)}),this.getServiceConditionInfo(),this.getOtherPageList(this.useName,this.roleid),this.formData.beginDay=Object(p.b)(this.formData.beginDay),this.formData.endDay=Object(p.b)(this.formData.endDay)},methods:{getOtherPageList:function(e,t){var a=this;this.companyList=[],d.a.getOtherPageList({page:1,pageSize:12,companyName:e,roleId:t}).then(function(e){e.obj&&(e.obj.records.map(function(e){return a.companyList.push(e.companyName)}),a.formData.companyName=a.companyList.length>1?"":a.companyList[0])})},getServiceConditionInfo:function(){var e=this;if(this.isSearchLoading=!0,this.formData.attendanceSign=String(Object(p.c)(this.formData.beginDay,this.formData.endDay)*(this.attendanceRate/100)).substring(0,4),this.serviceDate=s()({},{attendanceSign:this.formData.attendanceSign,beginDay:this.formData.beginDay,endDay:this.formData.endDay}),this.formData.canteenLevel=this.serviceLevel&&this.serviceLevel.join(","),this.formData.attendanceSign=this.attendNumber.toString(),"1"==this.type){this.streetCodeObj={code:""}}else if("3"==this.type){var t={streetCode:this.code[1],communityCode:""};this.streetCodeObj=t}else{var a={streetCode:this.streetCode,communityCode:this.code[0]};this.streetCodeObj=a}d.a.getServiceConsumeInfo(s()(this.formData,this.streetCodeObj,this.paramss)).then(function(t){if(t&&200===t.code&&t.data){e.isSearchLoading=!1,"1"==e.type?e.disabled=!1:(e.type,e.disabled=!0);var a=t.data,n=a.serviceConsumeAttendanceMap,i=a.serviceConsumeMap,o=a.allServiceConsumeMap,c=a.allServiceConsumeAttendanceMap;i&&i.forEach(function(e,t){n.length>0&&n.some(function(a){a.canteenNumberb===e.canteenNumbera&&(i[t].peoTotal=a.peoTotal)})}),e.tableData=i||[],e.tableData.map(function(e,t){e.key=t+1});var l=s.a.apply(Object,[{}].concat(r()(c),r()(o),[{merchantName:"合计"}]));e.totalData=l}})},objectSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex,e.columnIndex);if(t.merchantName&&-1!==t.merchantName.indexOf("合计")){return{rowspan:1,colspan:[0,4,0,0,1,1,1][a]}}},handleGetSearchValue:function(){this.getServiceConditionInfo()}},components:{ListLayout:f.a,Menu:m.a}},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("list-layout",{attrs:{columns:e.columns,tableData:e.tableData,pageSize:e.pageSize,header:"服务载体老年人消费频率",currentPage:e.currentPage,backPath:"FiveService",title:"五大服务类别数据综合分析———服务载体老年人消费频率",attendanceSign:e.formData.attendanceSign,attendNumber:e.attendNumber,companyName:e.formData.companyName,serviceDate:e.serviceDate,attendanceRate:e.attendanceRate,objectSpanMethod:e.objectSpanMethod}},[a("el-form",{attrs:{inline:!0,model:e.formData}},[a("el-form-item",{staticClass:"search_select search_time",attrs:{label:"起始时间"}},[a("el-date-picker",{attrs:{type:"date",clearable:!1,"value-format":"yyyy-MM-dd",placeholder:"开始日期"},model:{value:e.formData.beginDay,callback:function(t){e.$set(e.formData,"beginDay",t)},expression:"formData.beginDay"}}),e._v(" "),a("el-date-picker",{attrs:{type:"date",clearable:!1,"value-format":"yyyy-MM-dd",placeholder:"截止日期"},model:{value:e.formData.endDay,callback:function(t){e.$set(e.formData,"endDay",t)},expression:"formData.endDay"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"服务载体级别"}},[a("el-select",{attrs:{clearable:"",multiple:"",placeholder:"请选择载体级别"},model:{value:e.serviceLevel,callback:function(t){e.serviceLevel=t},expression:"serviceLevel"}},[a("el-option",{attrs:{label:"街级",value:"街级"}}),e._v(" "),a("el-option",{attrs:{label:"社区级",value:"社区级"}}),e._v(" "),a("el-option",{attrs:{label:"服务站",value:"服务站"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"服务商"}},[a("el-select",{attrs:{clearable:"",disabled:1===e.companyList.length,placeholder:"请选择服务商"},model:{value:e.formData.companyName,callback:function(t){e.$set(e.formData,"companyName",t)},expression:"formData.companyName"}},e._l(e.companyList,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"载体所属街道"}},[a("el-select",{attrs:{clearable:"",disabled:e.disabled,placeholder:"请选择所属街道"},model:{value:e.formData.streetCode,callback:function(t){e.$set(e.formData,"streetCode",t)},expression:"formData.streetCode"}},e._l(e.streetData,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"查询消费次数"}},[a("el-input",{attrs:{placeholder:"请输入消费次数"},model:{value:e.attendNumber,callback:function(t){e.attendNumber=t},expression:"attendNumber"}})],1)],1),e._v(" "),a("div",{staticClass:"btns_box"},[a("div",{staticClass:"data_total"},[a("span",[e._v("服务老年人数：")]),e._v(e._s(e.totalData.peopleTotal)+"人\n      "),a("span",[e._v("服务量：")]),e._v(e._s(e.totalData.serviceTotal)+"客次\n      "),a("span",[e._v("老年人消费频率人数：")]),e._v(e._s(e.totalData.peoTotal)+"人\n    ")]),e._v(" "),a("div",{staticClass:"btns_right"},[a("el-button",{staticClass:"btn",attrs:{icon:"el-icon-search",loading:e.isSearchLoading},on:{click:e.handleGetSearchValue}},[e._v("查询")])],1)]),e._v(" "),a("Menu")],1)};y._withStripped=!0;var g={render:y,staticRenderFns:[]},$=g;var S=!1;var C=a("VU/8")(b,$,!1,function(e){S||a("vPKh")},"data-v-44e5ece3",null);C.options.__file="src/views/ServiceConsumption/index.vue";t.default=C.exports},oqQY:function(e,t,a){var n;n=function(){"use strict";var e="millisecond",t="second",a="minute",n="hour",r="day",i="week",s="month",o="quarter",c="year",l="date",u="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(e,t,a){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(a)+e},p={s:m,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),n=Math.floor(a/60),r=a%60;return(t<=0?"+":"-")+m(n,2,"0")+":"+m(r,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var n=12*(a.year()-t.year())+(a.month()-t.month()),r=t.clone().add(n,s),i=a-r<0,o=t.clone().add(n+(i?-1:1),s);return+(-(n+(a-r)/(i?r-o:o-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(u){return{M:s,y:c,w:i,d:r,D:l,h:n,m:a,s:t,ms:e,Q:o}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",D={};D[v]=f;var b=function(e){return e instanceof S},y=function(e,t,a){var n;if(!e)return v;if("string"==typeof e)D[e]&&(n=e),t&&(D[e]=t,n=e);else{var r=e.name;D[r]=e,n=r}return!a&&n&&(v=n),n||!a&&v},g=function(e,t){if(b(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new S(a)},$=p;$.l=y,$.i=b,$.w=function(e,t){return g(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function f(e){this.$L=y(e.locale,null,!0),this.parse(e)}var m=f.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if($.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(d);if(n){var r=n[2]-1||0,i=(n[7]||"0").substring(0,3);return a?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return $},m.isValid=function(){return!(this.$d.toString()===u)},m.isSame=function(e,t){var a=g(e);return this.startOf(t)<=a&&a<=this.endOf(t)},m.isAfter=function(e,t){return g(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<g(e)},m.$g=function(e,t,a){return $.u(e)?this[t]:this.set(a,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,o){var u=this,d=!!$.u(o)||o,h=$.p(e),f=function(e,t){var a=$.w(u.$u?Date.UTC(u.$y,t,e):new Date(u.$y,t,e),u);return d?a:a.endOf(r)},m=function(e,t){return $.w(u.toDate()[e].apply(u.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),u)},p=this.$W,v=this.$M,D=this.$D,b="set"+(this.$u?"UTC":"");switch(h){case c:return d?f(1,0):f(31,11);case s:return d?f(1,v):f(0,v+1);case i:var y=this.$locale().weekStart||0,g=(p<y?p+7:p)-y;return f(d?D-g:D+(6-g),v);case r:case l:return m(b+"Hours",0);case n:return m(b+"Minutes",1);case a:return m(b+"Seconds",2);case t:return m(b+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(i,o){var u,d=$.p(i),h="set"+(this.$u?"UTC":""),f=(u={},u[r]=h+"Date",u[l]=h+"Date",u[s]=h+"Month",u[c]=h+"FullYear",u[n]=h+"Hours",u[a]=h+"Minutes",u[t]=h+"Seconds",u[e]=h+"Milliseconds",u)[d],m=d===r?this.$D+(o-this.$W):o;if(d===s||d===c){var p=this.clone().set(l,1);p.$d[f](m),p.init(),this.$d=p.set(l,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[$.p(e)]()},m.add=function(e,o){var l,u=this;e=Number(e);var d=$.p(o),h=function(t){var a=g(u);return $.w(a.date(a.date()+Math.round(t*e)),u)};if(d===s)return this.set(s,this.$M+e);if(d===c)return this.set(c,this.$y+e);if(d===r)return h(1);if(d===i)return h(7);var f=(l={},l[a]=6e4,l[n]=36e5,l[t]=1e3,l)[d]||1,m=this.$d.getTime()+e*f;return $.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||u;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=$.z(this),i=this.$H,s=this.$m,o=this.$M,c=a.weekdays,l=a.months,d=function(e,a,r,i){return e&&(e[a]||e(t,n))||r[a].substr(0,i)},f=function(e){return $.s(i%12||12,e,"0")},m=a.meridiem||function(e,t,a){var n=e<12?"AM":"PM";return a?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:$.s(o+1,2,"0"),MMM:d(a.monthsShort,o,l,3),MMMM:d(l,o),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:d(a.weekdaysMin,this.$W,c,2),ddd:d(a.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:$.s(i,2,"0"),h:f(1),hh:f(2),a:m(i,s,!0),A:m(i,s,!1),m:String(s),mm:$.s(s,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:r};return n.replace(h,function(e,t){return t||p[e]||r.replace(":","")})},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(e,l,u){var d,h=$.p(l),f=g(e),m=6e4*(f.utcOffset()-this.utcOffset()),p=this-f,v=$.m(this,f);return v=(d={},d[c]=v/12,d[s]=v,d[o]=v/3,d[i]=(p-m)/6048e5,d[r]=(p-m)/864e5,d[n]=p/36e5,d[a]=p/6e4,d[t]=p/1e3,d)[h]||p,u?v:$.a(v)},m.daysInMonth=function(){return this.endOf(s).$D},m.$locale=function(){return D[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),n=y(e,t,!0);return n&&(a.$L=n),a},m.clone=function(){return $.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},f}(),C=S.prototype;return g.prototype=C,[["$ms",e],["$s",t],["$m",a],["$H",n],["$W",r],["$M",s],["$y",c],["$D",l]].forEach(function(e){C[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),g.extend=function(e,t){return e.$i||(e(t,S,g),e.$i=!0),g},g.locale=y,g.isDayjs=b,g.unix=function(e){return g(1e3*e)},g.en=D[v],g.Ls=D,g.p={},g},e.exports=n()},vPKh:function(e,t,a){var n=a("ELa/");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("54babc25",n,!1,{})}});