webpackJsonp([65],{EVVi:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("OvRC"),r=a.n(l),o=a("woOf"),s=a.n(o),n=a("Dd8w"),i=a.n(n),c=a("NYxO"),u=a("P9l9"),h=a("sxQs"),m={data:function(){return{ops:{vuescroll:{},scrollPanel:{scrollingX:!1},bar:{background:"#eee"}},isSearchLoading:!1,columns:[{label:"序号",prop:"index",width:"150"},{label:"姓名",prop:"name"},{label:"性别",prop:"sex"},{label:"联系方式",prop:"oldPhone"},{label:"预警类型",prop:"eventType"},{label:"预警时间",prop:"alarmTime"},{label:"预警内容",prop:"alarmContent"},{label:"处理状态",prop:"state"},{label:"操作",prop:"warning"}],tableData:[],TypeList:["SOS预警","低电预警","健康预警"],StatusList:["未处理","在处理","已处理"],fullscreen:!0,selectedLocation:this.$route.query.code&&"string"!=typeof this.$route.query.code?this.$route.query.code.slice(1):[],index:1,locationProps:{value:"code",label:"name",children:"childs"},pageSize:10,currentPage:1,total:0,mealTime:"",formData:{Name:"",OldPhone:"",Sex:"",endTime:"",beginTime:"",EventType:"",state:""},params:{}}},computed:i()({},Object(c.b)(["userType","code"]),{userAuthCodeParams:function(){var e={};return 2===this.userType&&(e={zoneCode:this.initCodeFromQuery(1)}),3===this.userType&&(e={streetCode:this.initCodeFromQuery(2)}),4===this.userType&&(e={communityCode:this.initCodeFromQuery(3)}),s()({},{streetCode:"",zoneCode:"",communityCode:""},e)}}),created:function(){var e=this;this.$store.dispatch("getUserAuthInfo").then(function(){e.getLocation(),e.handleGetSearchValue()}).catch(function(e){console.log("获取用户权限失败",e)})},methods:{initCodeFromQuery:function(e){return this.$route.query.code&&"string"!=typeof this.$route.query.code&&this.$route.query.code[e]||""},requestParams:function(e){this.formData.beginTime=this.mealTime?new Date(this.mealTime[0]):"",this.formData.endTime=this.mealTime?new Date(this.mealTime[1]):"";var t=this.selectedLocation.length>0?r()(null):this.userAuthCodeParams;return s()({},this.formData,{page:"number"==typeof e?e:1,pageSize:this.pageSize},t)},handleGetSearchValue:function(e){var t=this;this.isSearchLoading=!0,u.a.getminfoPageList(this.requestParams(e)).then(function(e){t.isSearchLoading=!1;var a=e&&e.obj,l=a.records,r=a.total,o=a.size,s=a.current;t.tableData=l,t.pageSize=o,t.currentPage=s,t.total=r}).catch(function(){t.isSearchLoading=!1})},getLocation:function(){var e=this;u.a.getLocationList().then(function(t){var a=t.data,l=e.$store.state.code[0]||"";if(a&&a.length>0){var r=a.filter(function(e){return"河西区"==e.name})[0].childs,o=l?e.getLocalListByCode(r,l):[];e.locationOptions=o.length>0?o:r}}).catch(function(){console.log("查询片区数据失败")})},handleServiceClass:function(){this.currentPage=1},clearSearchValue:function(){this.formData=s()({},this.formData,{Name:"",OldPhone:"",Sex:"",EventType:"",state:""}),this.mealTime=""}},components:{ListLayout:h.a}},d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("list-layout",{attrs:{crumbData:[{title:this.$route.query.label,url:""}],columns:e.columns,tableData:e.tableData,total:e.total,pageSize:e.pageSize,currentPage:e.currentPage,backPath:"SmartdeviceStatistics",code:e.$route.query.code,title:"智能设备监测大数据统计分析——一键通预警记录"},on:{getSearchValue:e.handleGetSearchValue}},[a("el-form",{attrs:{inline:!0,model:e.formData}},[a("el-form-item",{staticClass:"search_select",attrs:{label:"姓名"}},[a("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入姓名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleGetSearchValue.apply(null,arguments)}},model:{value:e.formData.Name,callback:function(t){e.$set(e.formData,"Name","string"==typeof t?t.trim():t)},expression:"formData.Name"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"性别"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择性别"},model:{value:e.formData.Sex,callback:function(t){e.$set(e.formData,"Sex",t)},expression:"formData.Sex"}},[a("el-option",{attrs:{label:"男性",value:"男"}}),e._v(" "),a("el-option",{attrs:{label:"女性",value:"女"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"联系方式"}},[a("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入联系方式",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleGetSearchValue.apply(null,arguments)}},model:{value:e.formData.OldPhone,callback:function(t){e.$set(e.formData,"OldPhone","string"==typeof t?t.trim():t)},expression:"formData.OldPhone"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"预警类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择预警类型"},model:{value:e.formData.EventType,callback:function(t){e.$set(e.formData,"EventType",t)},expression:"formData.EventType"}},e._l(e.TypeList,function(t,l){return a("el-option",{key:l,attrs:{label:t,value:t},on:{change:e.handleServiceClass}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"处理状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择处理状态"},model:{value:e.formData.state,callback:function(t){e.$set(e.formData,"state",t)},expression:"formData.state"}},e._l(e.StatusList,function(t,l){return a("el-option",{key:l,attrs:{label:t,value:t},on:{change:e.handleServiceClass}})}),1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"预警时间"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-",clearable:"","start-placeholder":"开始时间","end-placeholder":"截止时间"},model:{value:e.mealTime,callback:function(t){e.mealTime=t},expression:"mealTime"}})],1)],1),e._v(" "),a("div",{staticClass:"btns_box"},[a("div",{staticClass:"btns_right"},[a("el-button",{staticClass:"btn",on:{click:e.clearSearchValue}},[e._v("重置")]),e._v(" "),a("el-button",{staticClass:"btn",attrs:{icon:"el-icon-search",loading:e.isSearchLoading},on:{click:e.handleGetSearchValue}},[e._v("查询")])],1)])],1)};d._withStripped=!0;var p={render:d,staticRenderFns:[]},f=p;var b=!1;var v=a("VU/8")(m,f,!1,function(e){b||a("qtuA")},"data-v-50533278",null);v.options.__file="src/views/WarningRecordList/index.vue";t.default=v.exports},ZbMZ:function(e,t,a){(e.exports=a("FZ+f")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"index.vue",sourceRoot:""}])},qtuA:function(e,t,a){var l=a("ZbMZ");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a("rjj0")("218d18f2",l,!1,{})}});