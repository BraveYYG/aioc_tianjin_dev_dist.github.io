webpackJsonp([54],{"62AU":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("OvRC"),o=r.n(a),s=r("fZjL"),i=r.n(s),l=r("woOf"),n=r.n(l),c=r("Dd8w"),d=r.n(c),u=r("NYxO"),m=r("P9l9"),h=r("bFzC"),p=function(e){var t="";if(e){var r=e.getMonth()+1>9?e.getMonth()+1:"0"+(e.getMonth()+1),a=e.getDate()>9?e.getDate():"0"+e.getDate();t=e.getFullYear()+"-"+r+"-"+a}return t},f={data:function(){return{isSearchLoading:!1,time:[this.$route.query.startTime?new Date(this.$route.query.startTime):"",this.$route.query.endTime?new Date(this.$route.query.endTime):""],ops:{vuescroll:{},scrollPanel:{scrollingX:!1},bar:{background:"#eee"}},columns:[{label:"下单时间",prop:"serviceOrderTime"},{label:"预约时间",prop:"appointmentsTime"},{label:"下单人",prop:"serviceOrderPerson"},{label:"工单编号",prop:"serviceOrderCard"},{label:"老人姓名",prop:"serviceOrderName"},{label:"联系电话",prop:"serviceOrderPhone"},{label:"服务大类",prop:"serviceCategory"},{label:"服务项目",prop:"serviceOrderItem"},{label:"工单状态",prop:"serviceOrderStatus"},{label:"收费标准",prop:"serviceOrderMoney"},{label:"工单等级",prop:"serviceOrderLevel"},{label:"家庭地址",prop:"serviceOrderAddress"},{label:"户籍地址",prop:"address"},{label:"服务商家",prop:"serviceOrderMerchant"},{label:"所属服务点",prop:"serviceOrderPoint"}],tableData:[],serviceOrderItemlist:["鲜鸡蛋一份","配餐","10元标准餐","15元标准餐","15元标准餐试餐","15元标准餐（12元补贴）"],serviceCategoryList:["居家保赠品","配餐"],fullscreen:!0,selectedLocation:this.$route.query.code&&"string"!=typeof this.$route.query.code?this.$route.query.code.slice(1):[],locationOptions:[],locationProps:{value:"code",label:"name",children:"childs"},pageSize:10,currentPage:1,total:0,formData:{userName:"",phone:"",serviceOrderCard:"",orderPerson:"",orderCreateTimeBegin:"",orderCreateTimeEnd:"",streetCode:this.initCodeFromQuery(2),zoneCode:this.initCodeFromQuery(1),communityCode:this.initCodeFromQuery(3),serviceCategory:"",serviceOrderItem:"",payTimeStart:"",payTimeEnd:"",mealTimeStart:"",mealTimeEnd:""},params:{}}},computed:d()({},Object(u.b)(["userType","code"]),{userAuthCodeParams:function(){var e={};return 2===this.userType&&(e={zoneCode:this.initCodeFromQuery(1)}),3===this.userType&&(e={streetCode:this.initCodeFromQuery(2)}),4===this.userType&&(e={communityCode:this.initCodeFromQuery(3)}),n()({},{streetCode:"",zoneCode:"",communityCode:""},e)},downloadExcel:function(){var e="/yanglao-api/serviceOrderInfo/downloadExcel?",t=n()({},this.requestParams(),{page:"",pageSize:""});return i()(t).forEach(function(r,a){e+=t[r]?r+"="+t[r]+"&":""}),e.slice(0,-1)}}),created:function(){var e=this;this.$store.commit("setActiveName",this.$route.query.label),this.$store.dispatch("getUserAuthInfo").then(function(){e.getLocation(),e.handleGetSearchValue()}).catch(function(e){console.log("获取用户权限失败",e)})},methods:{initCodeFromQuery:function(e){return this.$route.query.code&&"string"!=typeof this.$route.query.code&&this.$route.query.code[e]||""},requestParams:function(e){var t=p(this.time?this.time[0]:""),r=p(this.time?this.time[1]:""),a=this.selectedLocation.length>0?o()(null):this.userAuthCodeParams;return n()({},this.formData,{page:"number"==typeof e?e:1,pageSize:this.pageSize,orderCreateTimeBegin:t?t+" 00:00:00":"",orderCreateTimeEnd:r?r+" 23:59:59":""},a)},handleGetSearchValue:function(e){var t=this;this.isSearchLoading=!0,m.a.getOrderPage(this.requestParams(e)).then(function(e){t.isSearchLoading=!1;var r=e&&e.obj,a=r.records,o=r.total,s=r.size,i=r.current;t.tableData=a,t.pageSize=s,t.currentPage=i,t.total=o}).catch(function(){t.isSearchLoading=!1})},handleChangeLocation:function(e){"3"===this.userType?(this.formData.streetCode=e[0]||"",this.formData.communityCode=e[1]||""):"4"===this.userType?this.formData.communityCode=e[0]||"":(this.formData.zoneCode=e[0]||"",this.formData.streetCode=e[1]||"",this.formData.communityCode=e[2]||"")},getLocation:function(){var e=this;m.a.getLocationList().then(function(t){var r=t.data,a=e.$store.state.code[0]||"";if(r&&r.length>0){var o=r.filter(function(e){return"河西区"===e.name})[0].childs,s=a?e.getLocalListByCode(o,a):[];e.locationOptions=s.length>0?s:o}}).catch(function(e){console.log("查询片区数据失败",e)})},getLocalListByCode:function(e,t){var r=[];return function e(a){var o=[];if(a&&(o=a.filter(function(r){return r.code===t||!!(r.childs&&r.childs.length>0)&&void e(r.childs)})).length>0)return r=o,!1}(e),r},openDialog:function(){this.$store.commit("setNavDialogVisible",!0)},handleServiceClass:function(){this.currentPage=1,this.getOlderData()},clearSearchValue:function(){this.formData=n()({},this.formData,{userName:"",phone:"",serviceOrderCard:"",orderPerson:"",orderCreateTimeBegin:"",orderCreateTimeEnd:"",serviceCategory:"",serviceOrderItem:"",zoneCode:"",streetCode:"",communityCode:""}),this.searchService="",this.selectedLocation=[],this.time=null}},components:{ListLayout:h.a}},v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("list-layout",{attrs:{crumbData:[{title:this.$route.query.label,url:""}],columns:e.columns,tableData:e.tableData,total:e.total,pageSize:e.pageSize,currentPage:e.currentPage},on:{getSearchValue:e.handleGetSearchValue}},[r("el-form",{attrs:{inline:!0,model:e.formData}},[r("el-form-item",{staticClass:"search_select",attrs:{label:"用户姓名"}},[r("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入用户姓名",clearable:""},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName","string"==typeof t?t.trim():t)},expression:"formData.userName"}})],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"联系电话"}},[r("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入联系电话",clearable:""},model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone","string"==typeof t?t.trim():t)},expression:"formData.phone"}})],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"工单编号"}},[r("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入工单编号",clearable:""},model:{value:e.formData.serviceOrderCard,callback:function(t){e.$set(e.formData,"serviceOrderCard","string"==typeof t?t.trim():t)},expression:"formData.serviceOrderCard"}})],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"下单人"}},[r("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入下单人",clearable:""},model:{value:e.formData.orderPerson,callback:function(t){e.$set(e.formData,"orderPerson","string"==typeof t?t.trim():t)},expression:"formData.orderPerson"}})],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"下单时间"}},[r("el-date-picker",{attrs:{type:"daterange","range-separator":"-",clearable:"","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"地区筛选"}},[r("el-cascader",{attrs:{placeholder:"选择地区",options:e.locationOptions,"show-all-levels":!1,"change-on-select":"",filterable:"",clearable:"",props:e.locationProps},on:{change:e.handleChangeLocation},model:{value:e.selectedLocation,callback:function(t){e.selectedLocation=t},expression:"selectedLocation"}})],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"服务大类"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择服务大类"},model:{value:e.formData.serviceCategory,callback:function(t){e.$set(e.formData,"serviceCategory",t)},expression:"formData.serviceCategory"}},e._l(e.serviceCategoryList,function(t,a){return r("el-option",{key:a,attrs:{label:t,value:t},on:{change:e.handleServiceClass}})}),1)],1),e._v(" "),r("el-form-item",{staticClass:"search_select",attrs:{label:"服务项目"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择服务项目"},model:{value:e.formData.serviceOrderItem,callback:function(t){e.$set(e.formData,"serviceOrderItem",t)},expression:"formData.serviceOrderItem"}},e._l(e.serviceOrderItemlist,function(t,a){return r("el-option",{key:a,attrs:{label:t,value:t},on:{change:e.handleServiceClass}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"btns_box"},[r("div",{staticClass:"btns_right"},[r("el-button",{staticClass:"btn",on:{click:e.clearSearchValue}},[e._v("重置")]),e._v(" "),r("el-button",{staticClass:"btn",attrs:{icon:"el-icon-search",loading:e.isSearchLoading},on:{click:e.handleGetSearchValue}},[e._v("查询")]),e._v(" "),r("a",{attrs:{href:e.downloadExcel,target:"_blank"}},[r("el-button",{staticClass:"btn"},[e._v("导出")])],1)],1)])],1)};v._withStripped=!0;var g={render:v,staticRenderFns:[]},C=g;var b=!1;var y=r("VU/8")(f,C,!1,function(e){b||r("DNpH")},"data-v-a042d4c2",null);y.options.__file="src/views/ServiceWork/index.vue";t.default=y.exports},DNpH:function(e,t,r){var a=r("Ri6Q");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("rjj0")("2c4e7b7a",a,!1,{})},Ri6Q:function(e,t,r){(e.exports=r("FZ+f")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"index.vue",sourceRoot:""}])}});