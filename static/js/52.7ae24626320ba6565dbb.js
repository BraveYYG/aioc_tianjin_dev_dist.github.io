webpackJsonp([52],{"8zDF":function(e,t,a){var o=a("eXtl");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("5c7ad35e",o,!1,{})},UCNa:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("OvRC"),r=a.n(o),n=a("fZjL"),i=a.n(n),l=a("woOf"),s=a.n(l),c=a("Dd8w"),h=a.n(c),u=a("P9l9"),d=a("BD25"),m=a("88Um"),f=a("Iu7O"),p=a("cS7h"),y=a("bFzC"),b=a("NYxO"),g={components:{Header:d.a,PageHeader:m.a,BreadCrumb:f.a,Navigation:p.a,ListLayout:y.a},data:function(){return{isSearchLoading:!1,ops:{vuescroll:{},scrollPanel:{scrollingX:!1},rail:{},bar:{background:"#eee"}},columns:[{label:"姓名",prop:"name"},{label:"性别",prop:"sex"},{label:"身份证号码",prop:"idcardNumber"},{label:"民族",prop:"localNation"},{label:"本人联系方式",prop:"emergencyPhone"},{label:"出生日期",prop:"birthday"},{label:"年龄",prop:"age"},{label:"所属服务点",prop:"servicePoint"},{label:"详细地址",prop:"address"}],tableData:[],nationalData:["汉族","蒙古族","满族","朝鲜族","赫哲族","达斡尔族","鄂温克族","鄂伦春族","回族","东乡族","土族","撒拉族","保安族","裕固族","维吾尔族","哈萨克族","柯尔克孜族","锡伯族","塔吉克族","乌孜别克族","俄罗斯族","塔塔尔族","藏族","门巴族","珞巴族","羌族","彝族","白族","哈尼族","傣族","僳僳族","佤族","拉祜族","纳西族","景颇族","布朗族","阿昌族","普米族","怒族","德昂族","独龙族","基诺族","苗族","布依族","侗族","水族","仡佬族","壮族","瑶族","仫佬族","毛南族","京族","土家族","黎族","畲族","高山族"],fullscreen:!0,selectedLocation:this.$route.query.code&&"string"!=typeof this.$route.query.code?this.$route.query.code.slice(1):[],locationOptions:[],locationProps:{value:"code",label:"name",children:"childs"},birthdayMonth:"",birthdayDay:"",formData:{name:"",idCard:"",service:"",sex:"",ageFrom:"",ageTo:"",birthday:"",districtCode:this.initCodeFromQuery(1),streetCode:this.initCodeFromQuery(2),communityCode:this.initCodeFromQuery(3),nation:""},pageSize:10,currentPage:1,total:0}},computed:h()({},Object(b.b)(["userType","code"]),{userAuthCodeParams:function(){var e={};return 2===this.userType&&(e={districtCode:this.initCodeFromQuery(1)}),3===this.userType&&(e={streetCode:this.initCodeFromQuery(2)}),4===this.userType&&(e={communityCode:this.initCodeFromQuery(3)}),s()({},{streetCode:"",districtCode:"",communityCode:""},e)},monthLength:function(){return 2===this.birthdayMonth?28:31},downloadExcel:function(){var e="/yanglao-api/basePersonSecond/downloadExcel?",t=s()({},this.requestParams(),{page:"",pageSize:""});return i()(t).forEach(function(a,o){e+=t[a]?a+"="+t[a]+"&":""}),e.slice(0,-1)}}),created:function(){var e=this;this.$store.commit("setActiveName","服务老人"),this.$store.dispatch("getUserAuthInfo").then(function(){e.getLocation(),e.handleGetSearchValue()}).catch(function(e){console.log("获取用户权限失败",e)})},methods:{initCodeFromQuery:function(e){return this.$route.query.code&&"string"!=typeof this.$route.query.code&&this.$route.query.code[e]||""},requestParams:function(e){var t=this.selectedLocation.length>0?r()(null):this.userAuthCodeParams;return s()({},this.formData,{page:"number"==typeof e?e:1,pageSize:this.pageSize},t)},handleChangeMonth:function(e){this.birthdayMonth=e?e>9?e:"0"+e:"",this.formData.birthday=this.birthdayDay&&this.birthdayMonth?""+this.birthdayMonth+this.birthdayDay:""},handleChangeDay:function(e){var t=e?e>9?e:"0"+e:"";this.birthdayDay=t;var a=this.birthdayMonth?this.birthdayMonth:"";this.formData.birthday=t&&a?""+a+t:""},handleChangeStartAge:function(e){this.formData.ageFrom=isNaN(parseInt(e))?"":parseInt(e)},handleChangeEndAge:function(e){this.formData.ageTo=isNaN(parseInt(e))?"":parseInt(e)},handleGetSearchValue:function(e){var t=this;this.isSearchLoading=!0,u.a.getOlderServies(this.requestParams(e)).then(function(e){t.isSearchLoading=!1;var a=e&&e.obj,o=a.records,r=a.total,n=a.size,i=a.current;t.tableData=o,t.pageSize=n,t.currentPage=i,t.total=r}).catch(function(){t.isSearchLoading=!1})},handleChangeLocation:function(e){"3"===this.$store.state.userType?(this.formData.streetCode=e[0]||"",this.formData.communityCode=e[1]||""):"4"===this.$store.state.userType?this.formData.communityCode=e[0]||"":(this.formData.districtCode=e[0]||"",this.formData.streetCode=e[1]||"",this.formData.communityCode=e[2]||"")},getLocation:function(){var e=this;u.a.getLocationList().then(function(t){var a=t.data,o=e.$store.state.code[0]||"";if(a&&a.length>0){var r=a.filter(function(e){return"河西区"===e.name})[0].childs,n=o?e.getLocalListByCode(r,o):[];e.locationOptions=n.length>0?n:r}}).catch(function(){console.log("查询片区数据失败")})},getLocalListByCode:function(e,t){var a=[];return function e(o){var r=[];if(o&&(r=o.filter(function(a){return a.code===t||!!(a.childs&&a.childs.length>0)&&void e(a.childs)})).length>0)return a=r,!1}(e),a},openDialog:function(){this.$store.commit("setNavDialogVisible",!0)},getSearchValue:function(){this.currentPage=1,this.getOlderData()},clearSearchValue:function(){this.formData={sex:"",ageFrom:"",ageTo:"",birthday:"",districtCode:"",streetCode:"",communityCode:"",nation:"",name:"",idCard:"",service:""},this.birthdayMonth="",this.birthdayDay="",this.selectedLocation=[]}}},v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("list-layout",{attrs:{crumbData:[{title:"服务老人",url:""}],columns:e.columns,tableData:e.tableData,total:e.total,pageSize:e.pageSize,currentPage:e.currentPage},on:{getSearchValue:e.handleGetSearchValue}},[a("el-form",{attrs:{inline:!0,model:e.formData}},[a("el-form-item",{staticClass:"search_select",attrs:{label:"姓名"}},[a("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入姓名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchValue.apply(null,arguments)}},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name","string"==typeof t?t.trim():t)},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"性别"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择性别"},model:{value:e.formData.sex,callback:function(t){e.$set(e.formData,"sex",t)},expression:"formData.sex"}},[a("el-option",{attrs:{label:"男性",value:"男"}}),e._v(" "),a("el-option",{attrs:{label:"女性",value:"女"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"身份证号码"}},[a("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入身份证号码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchValue.apply(null,arguments)}},model:{value:e.formData.idCard,callback:function(t){e.$set(e.formData,"idCard","string"==typeof t?t.trim():t)},expression:"formData.idCard"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"民族"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择民族"},model:{value:e.formData.nation,callback:function(t){e.$set(e.formData,"nation",t)},expression:"formData.nation"}},[e._l(e.nationalData,function(e,t){return[a("el-option",{key:t,attrs:{label:e,value:e}})]})],2)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"出生日期"}},[a("el-select",{staticClass:"input_num",attrs:{clearable:"",placeholder:"月份"},on:{change:e.handleChangeMonth},model:{value:e.birthdayMonth,callback:function(t){e.birthdayMonth=t},expression:"birthdayMonth"}},[e._l(12,function(e){return[a("el-option",{key:"month_"+e,attrs:{label:e,value:e}})]})],2),e._v(" "),a("span",[e._v("-")]),e._v(" "),a("el-select",{staticClass:"input_num",attrs:{clearable:"",placeholder:"日期"},on:{change:e.handleChangeDay},model:{value:e.birthdayDay,callback:function(t){e.birthdayDay=t},expression:"birthdayDay"}},[e._l(e.monthLength,function(e){return[a("el-option",{key:"day_"+e,attrs:{label:e,value:e}})]})],2)],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"年龄段"}},[a("el-input",{staticClass:"input_num",attrs:{placeholder:"起始年龄"},on:{change:e.handleChangeStartAge},model:{value:e.formData.ageFrom,callback:function(t){e.$set(e.formData,"ageFrom",t)},expression:"formData.ageFrom"}}),e._v(" "),a("span",[e._v("-")]),e._v(" "),a("el-input",{staticClass:"input_num",attrs:{placeholder:"截止年龄"},on:{change:e.handleChangeEndAge},model:{value:e.formData.ageTo,callback:function(t){e.$set(e.formData,"ageTo",t)},expression:"formData.ageTo"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"地区筛选"}},[a("el-cascader",{attrs:{placeholder:"选择地区",options:e.locationOptions,"show-all-levels":!1,"change-on-select":"",filterable:"",clearable:"",props:e.locationProps},on:{change:e.handleChangeLocation},model:{value:e.selectedLocation,callback:function(t){e.selectedLocation=t},expression:"selectedLocation"}})],1),e._v(" "),a("el-form-item",{staticClass:"search_select",attrs:{label:"所属服务点"}},[a("el-input",{staticClass:"head_left",attrs:{placeholder:"请输入所属服务点",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchValue.apply(null,arguments)}},model:{value:e.formData.service,callback:function(t){e.$set(e.formData,"service","string"==typeof t?t.trim():t)},expression:"formData.service"}})],1)],1),e._v(" "),a("div",{staticClass:"btns_box"},[a("div",{staticClass:"btns_right"},[a("el-button",{staticClass:"btn",on:{click:e.clearSearchValue}},[e._v("重置")]),e._v(" "),a("el-button",{staticClass:"btn",attrs:{icon:"el-icon-search",loading:e.isSearchLoading},on:{click:e.handleGetSearchValue}},[e._v("查询")]),e._v(" "),a("a",{attrs:{href:e.downloadExcel}},[a("el-button",{staticClass:"btn"},[e._v("导出")])],1)],1)])],1)],1)};v._withStripped=!0;var C={render:v,staticRenderFns:[]},D=C;var _=!1;var k=a("VU/8")(g,D,!1,function(e){_||a("8zDF")},"data-v-e7bc256a",null);k.options.__file="src/views/OlderServices/index.vue";t.default=k.exports},eXtl:function(e,t,a){(e.exports=a("FZ+f")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"index.vue",sourceRoot:""}])}});